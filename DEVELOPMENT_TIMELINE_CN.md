<div align="center">

# 📅 FilNote 开发时间线

**从概念到生产的完整历程**

[![状态](https://img.shields.io/badge/状态-积极开发中-brightgreen.svg)]()
[![版本](https://img.shields.io/badge/版本-1.0-blue.svg)]()
[![网络](https://img.shields.io/badge/网络-Filecoin%20EVM-orange.svg)]()

</div>

---

## 📊 项目概述

FilNote 是一个基于 **Filecoin EVM** 构建的去中心化投资票据管理平台，使创建者能够发行投资票据，投资者参与融资，审计员审查和批准投资机会。该平台集成了 **IPFS** 用于风险信息和隐私凭证的永久存储。

### 项目统计

| 指标                 | 数值                                       |
| -------------------- | ------------------------------------------ |
| **总开发时间**       | 4 个月（2025 年 9 月-12 月）               |
| **智能合约代码行数** | ~750 行                                    |
| **核心合约**         | 2 个（FilNoteContract, ProtocolsContract） |
| **前端组件**         | 11+ 个 Vue 组件                            |
| **后端服务**         | 5+ 个 NestJS 模块                          |
| **Git 提交**         | 23+ 次提交                                 |
| **项目状态**         | 积极开发中                                 |

---

## 🗓️ 开发阶段

```
┌─────────────────────────────────────────────────────────────┐
│                    开发时间线                                │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  2025年9月      2025年10月      2025年11月    2025年12月   │
│     │               │               │            │          │
│     ▼               ▼               ▼            ▼          │
│  ┌────────┐      ┌────────┐      ┌────────┐   ┌────────┐  │
│  │ 第一阶段│─────▶│ 第二阶段│─────▶│ 第三阶段│──▶│ 第四阶段│  │
│  │核心合约 │      │前端界面 │      │审计员   │   │IPFS集成 │  │
│  │        │      │  v1.0  │      │功能     │   │        │  │
│  └────────┘      └────────┘      └────────┘   └────────┘  │
│                                                              │
└─────────────────────────────────────────────────────────────┘
```

---

## 🏗️ 第一阶段：核心合约设计

**时间**: 2025 年 9 月  
**时长**: 1 个月  
**重点**: 智能合约基础

### 📋 目标

建立基础的智能合约架构，包含核心投资票据功能、平台审核机制和投资者参与功能。

### 🎯 关键交付物

#### 智能合约架构

| 合约                      | 行数 | 函数数 | 用途                   |
| ------------------------- | ---- | ------ | ---------------------- |
| **FilNoteContract.sol**   | 575  | 20+    | 票据生命周期管理主合约 |
| **ProtocolsContract.sol** | 168  | 6      | 单个投资协议管理       |
| **Types.sol**             | 155  | -      | 数据结构和错误定义     |

#### 核心功能实现

| 功能         | 实现方式                               | 状态 |
| ------------ | -------------------------------------- | ---- |
| **票据创建** | `createNote()` 带验证                  | ✅   |
| **投资处理** | `invest()` 自动协议部署                | ✅   |
| **状态管理** | 7 状态生命周期系统                     | ✅   |
| **平台费用** | 可配置费用系统（默认 2%）              | ✅   |
| **查询函数** | 分页支持（最多 100 条）                | ✅   |
| **安全机制** | OpenZeppelin Ownable + ReentrancyGuard | ✅   |

#### 技术规格

```yaml
Solidity 版本: ^0.8.22
框架: Foundry
依赖项:
  - OpenZeppelin Contracts: v5.x
  - Forge Std: 最新版
  - Filecoin Solidity API: ^1.1.3
网络: Filecoin EVM (Calibration 测试网)
优化器: 启用（200 次运行）
Via IR: 启用
```

#### 开发里程碑

| 周次        | 重点       | 交付物             |
| ----------- | ---------- | ------------------ |
| **第 1 周** | 初始结构   | 合约骨架，基本类型 |
| **第 2 周** | 核心功能   | 票据创建，投资流程 |
| **第 3 周** | 协议合约   | 单个协议管理       |
| **第 4 周** | 安全与测试 | 安全加固，部署     |

#### Git 提交记录

- `4ad4a68` - 初始部署
- `bc44a82` - 合约修改
- `7285cfa`, `591a86f` - Gas 优化

#### 主要成就

- ✅ 完整的票据生命周期管理
- ✅ 自动协议合约部署
- ✅ 全面的输入验证
- ✅ Gas 优化的查询函数
- ✅ 安全最佳实践实现

---

## 🎨 第二阶段：前端界面 v1.0

**时间**: 2025 年 10 月  
**时长**: 1 个月  
**重点**: 用户界面开发

### 📋 目标

开发用户界面 Web 应用的第一版，具备票据创建、浏览和投资的核心交互能力。

### 🎯 关键交付物

#### 前端架构

| 组件         | 技术                        | 用途       |
| ------------ | --------------------------- | ---------- |
| **框架**     | Quasar (Vue 3 + TypeScript) | UI 框架    |
| **状态管理** | Pinia                       | 应用状态   |
| **区块链**   | Filecoin AppKit             | 钱包集成   |
| **样式**     | Tailwind CSS + Quasar       | UI 样式    |
| **国际化**   | Vue I18n                    | 多语言支持 |

#### 核心组件

| 组件                        | 用途           | 行数 |
| --------------------------- | -------------- | ---- |
| `CreateNote.vue`            | 票据创建表单   | ~100 |
| `NoteItem.vue`              | 票据卡片展示   | ~80  |
| `InvestmentRecognition.vue` | 投资界面       | ~120 |
| `ReviewNote.vue`            | 审计员审核界面 | ~150 |
| `ConnectingWallets.vue`     | 钱包连接       | ~60  |
| `WriteContract.vue`         | 通用写操作     | ~90  |
| `ReadContract.vue`          | 通用读操作     | ~70  |
| `AgreementDetails.vue`      | 票据详情视图   | ~200 |
| `NoteCountdown.vue`         | 到期倒计时     | ~50  |

#### 功能实现

| 功能            | 描述                   | 状态 |
| --------------- | ---------------------- | ---- |
| **钱包集成**    | 通过 AppKit 支持多钱包 | ✅   |
| **票据创建 UI** | 带验证的表单           | ✅   |
| **票据浏览**    | 带分页的列表视图       | ✅   |
| **投资流程**    | 风险披露 + 投资        | ✅   |
| **状态指示器**  | 可视化状态表示         | ✅   |
| **响应式设计**  | 移动端友好布局         | ✅   |
| **国际化**      | 英语和中文支持         | ✅   |

#### 开发里程碑

| 周次        | 重点     | 交付物                |
| ----------- | -------- | --------------------- |
| **第 1 周** | 组件结构 | 核心组件，路由        |
| **第 2 周** | 钱包集成 | AppKit 集成，连接流程 |
| **第 3 周** | 合约交互 | 写/读组件，错误处理   |
| **第 4 周** | UI 优化  | 样式，动画，用户反馈  |

#### Git 提交记录

- `1779ae9`, `d0cb6ac` - 前端优化
- `338168c`, `9ffcb46` - UI 修改
- `1e3577f`, `8742991` - 错误修复
- `da8cbc5` - 功能添加
- `892ced8`, `7de93bd` - UI 增强

#### 主要成就

- ✅ 所有操作的完整用户界面
- ✅ 无缝钱包集成
- ✅ 直观的用户体验
- ✅ 响应式设计
- ✅ 多语言支持

---

## 👥 第三阶段：审计员功能

**时间**: 2025 年 11 月  
**时长**: 1 个月  
**重点**: 审计员角色和审核工作流

### 📋 目标

实现全面的审计员角色管理和票据审核工作流，确保投资质量和合规性。

### 🎯 关键交付物

#### 审计员管理系统

| 功能           | 实现方式                          | 影响                   |
| -------------- | --------------------------------- | ---------------------- |
| **角色控制**   | `addAuditor()`, `removeAuditor()` | 所有者管理的审计员列表 |
| **访问控制**   | `onlyAuditor` 修饰符              | 受限的票据批准         |
| **查询优化**   | 基于 mapping 的 O(1) 查询         | Gas 节省：~90-99%      |
| **审核工作流** | `pendingNote()` 函数              | 状态转换控制           |

#### Gas 优化结果

| 审计员数量 | 优化前 (Gas) | 优化后 (Gas) | 节省 |
| ---------- | ------------ | ------------ | ---- |
| 10         | ~21,000      | ~2,100       | 90%  |
| 50         | ~97,000      | ~2,100       | 98%  |
| 100        | ~192,000     | ~2,100       | 99%  |

#### 后端增强

| 服务                | 用途               | 状态 |
| ------------------- | ------------------ | ---- |
| `auditor.guard.ts`  | 基于签名的身份验证 | ✅   |
| `verify.service.ts` | 文件上传处理       | ✅   |
| 审计员路由          | 受保护的 API 端点  | ✅   |

#### 前端组件

| 组件             | 用途          | 状态 |
| ---------------- | ------------- | ---- |
| `ReviewNote.vue` | 审计员仪表板  | ✅   |
| 审计员导航       | 基于角色的 UI | ✅   |
| 权限检查         | 访问控制 UI   | ✅   |

#### 安全改进

| 改进         | 描述                 | 状态 |
| ------------ | -------------------- | ---- |
| **算术溢出** | 修复计算中的潜在溢出 | ✅   |
| **输入验证** | 增强审计员操作验证   | ✅   |
| **访问控制** | 多层权限检查         | ✅   |

#### 开发里程碑

| 周次        | 重点           | 交付物            |
| ----------- | -------------- | ----------------- |
| **第 1 周** | 审计员角色管理 | 智能合约函数      |
| **第 2 周** | 审核工作流     | 后端 API，前端 UI |
| **第 3 周** | 安全修复       | 溢出保护，优化    |
| **第 4 周** | 测试与优化     | 集成测试，UI 改进 |

#### Git 提交记录

- `7d5f848` - 算术溢出错误修复
- 多个提交用于审计员功能实现

#### 主要成就

- ✅ 完整的审计员角色管理
- ✅ 高效的 O(1) 审计员查询
- ✅ 安全的审核工作流
- ✅ Gas 优化（节省 90-99%）
- ✅ 全面的访问控制

---

## 📦 第四阶段：IPFS 集成与风险信息

**时间**: 2025 年 12 月  
**时长**: 1 个月  
**重点**: 永久存储和隐私管理

### 📋 目标

在 IPFS 上实现风险信息和隐私凭证的永久存储，基于区块链的验证和访问控制。

### 🎯 关键交付物

#### IPFS 存储集成

| 服务            | 用途                     | 状态 |
| --------------- | ------------------------ | ---- |
| **Pinata 服务** | 通过 API 上传文件到 IPFS | ✅   |
| **文件上传**    | 合同和隐私凭证上传       | ✅   |
| **加密服务**    | 隐私凭证加密             | ✅   |
| **访问控制**    | 基于投资的解密           | ✅   |

#### 智能合约增强

| 字段                             | 类型   | 用途                          |
| -------------------------------- | ------ | ----------------------------- |
| `contractHash`                   | string | 合同的 IPFS CID（必填，公开） |
| `privacyCertificateHash`         | string | 加密的 IPFS CID（可选）       |
| `privacyCredentialsAbridgedHash` | string | 公开预览 JSON（可选）         |

#### 数据访问模型

```
┌─────────────────────────────────────────┐
│           信息访问模型                    │
├─────────────────────────────────────────┤
│                                         │
│  公开（无需投资）：                       │
│  ├─ 合约哈希 (IPFS)                      │
│  ├─ 摘要凭证 (JSON)                      │
│  └─ 基本票据信息                          │
│                                         │
│  私有（需要投资）：                       │
│  ├─ 加密隐私凭证                          │
│  ├─ 完整风险评估                          │
│  └─ 完整财务信息                          │
│                                         │
└─────────────────────────────────────────┘
```

#### 后端 API 功能

| 端点                    | 用途               | 状态 |
| ----------------------- | ------------------ | ---- |
| `POST /verify/upload`   | 文件上传到 IPFS    | ✅   |
| `POST /encrypt/decrypt` | 隐私凭证解密       | ✅   |
| 签名验证                | 基于地址的身份验证 | ✅   |
| 数据库集成              | 临时存储 (LowDB)   | ✅   |

#### 前端增强

| 功能          | 描述             | 状态 |
| ------------- | ---------------- | ---- |
| **文件上传**  | 拖放界面         | ✅   |
| **IPFS 链接** | 合同文档查看     | ✅   |
| **访问控制**  | 公开/私有信息 UI | ✅   |
| **风险预览**  | 摘要凭证展示     | ✅   |

#### 永久存储优势

| 优势         | 描述                       |
| ------------ | -------------------------- |
| **不可变性** | 所有文档永久存储在 IPFS 上 |
| **去中心化** | 分布在 Filecoin 网络上     |
| **透明度**   | 公开合同验证               |
| **审计跟踪** | 所有条款的永久记录         |

#### 开发里程碑

| 周次        | 重点      | 交付物                |
| ----------- | --------- | --------------------- |
| **第 1 周** | IPFS 集成 | Pinata 服务，文件上传 |
| **第 2 周** | 加密服务  | 隐私凭证加密          |
| **第 3 周** | 访问控制  | 基于投资的解密        |
| **第 4 周** | UI 集成   | 文件上传 UI，文档查看 |

#### Git 提交记录

- `79230df` - 从 createNote 中移除 privacyCertificateHash
- `a806316` - 新合约功能的 ABI 更新
- `847c64d` - 合约地址和文档更新
- `009f55a` - 隐私凭证管理文档
- `c3064d2` - STOP 状态文档修复

#### 主要成就

- ✅ 完整的 IPFS 集成
- ✅ 加密隐私凭证管理
- ✅ 公开预览信息系统
- ✅ 基于投资的访问控制
- ✅ 永久文档存储

---

## 📈 项目统计

### 代码指标

| 指标                | 数值 |
| ------------------- | ---- |
| **Solidity 总行数** | ~750 |
| **总函数数**        | 30+  |
| **总事件数**        | 8    |
| **自定义错误**      | 15   |
| **状态变量**        | 13   |
| **前端组件**        | 11+  |
| **后端服务**        | 5+   |

### 开发时间线

| 阶段     | 时长   | 提交数 | 功能       |
| -------- | ------ | ------ | ---------- |
| 第一阶段 | 1 个月 | 5+     | 核心合约   |
| 第二阶段 | 1 个月 | 8+     | 前端 v1.0  |
| 第三阶段 | 1 个月 | 3+     | 审计员系统 |
| 第四阶段 | 1 个月 | 5+     | IPFS 集成  |

---

## 🛠️ 技术栈

### 智能合约

| 组件   | 技术         | 版本             |
| ------ | ------------ | ---------------- |
| 语言   | Solidity     | ^0.8.22          |
| 框架   | Foundry      | 最新版           |
| 安全库 | OpenZeppelin | v5.x             |
| 网络   | Filecoin EVM | Calibration/主网 |

### 前端

| 组件   | 技术            | 用途               |
| ------ | --------------- | ------------------ |
| 框架   | Quasar          | Vue 3 + TypeScript |
| 状态   | Pinia           | 状态管理           |
| 区块链 | Filecoin AppKit | 钱包集成           |
| 样式   | Tailwind CSS    | UI 样式            |

### 后端

| 组件   | 技术          | 用途       |
| ------ | ------------- | ---------- |
| 框架   | NestJS        | API 服务器 |
| 语言   | TypeScript    | 类型安全   |
| 区块链 | Ethers.js     | 合约交互   |
| 存储   | IPFS (Pinata) | 文件存储   |

---

## 🎯 主要成就

### 安全性

- ✅ 全面的安全审计
- ✅ OpenZeppelin 最佳实践
- ✅ Gas 优化（90-99% 改进）
- ✅ 全面的输入验证
- ✅ 重入保护

### 功能性

- ✅ 完整的投资生命周期
- ✅ 多审计员审批系统
- ✅ IPFS 永久存储
- ✅ 隐私凭证管理
- ✅ 高效的查询函数

### 用户体验

- ✅ 直观的前端界面
- ✅ 多钱包支持
- ✅ 响应式设计
- ✅ 国际化
- ✅ 实时状态更新

---

## 🔮 未来增强

### 计划功能

| 功能           | 优先级 | 状态   |
| -------------- | ------ | ------ |
| 多签审计员批准 | 高     | 计划中 |
| 高级风险评分   | 中     | 计划中 |
| 自动化合规检查 | 中     | 计划中 |
| 增强分析       | 低     | 计划中 |
| 移动应用       | 低     | 计划中 |
| 跨链兼容性     | 低     | 未来   |

---

## 📚 文档

- [README.md](./README.md) - 主要文档
- [README_CN.md](./README_CN.md) - 中文文档
- [DEVELOPMENT_TIMELINE.md](./DEVELOPMENT_TIMELINE.md) - 英文时间线

---

## 🔗 相关仓库

- [FilNoteFEVMFront](https://github.com/filnote/FilNoteFEVMFront) - 前端应用
- [FilNoteFEVMAPI](https://github.com/filnote/FilNoteFEVMAPI) - 后端 API 服务

---

<div align="center">

**文档版本**: 1.0  
**最后更新**: 2026 年 1 月  
**项目状态**: 积极开发中

[⬆ 返回顶部](#-filnote-开发时间线)

</div>
